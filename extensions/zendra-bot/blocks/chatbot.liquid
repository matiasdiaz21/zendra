<script src="{{ 'purify.min.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'chatbot.js' | asset_url }}" defer="defer"></script>
{{ 'chatbot.css' | asset_url | stylesheet_tag }}

<!-- Botón flotante del chat -->
<div id="chatbot-toggle" style="bottom: {{ block.settings.toggle_bottom }}; right: {{ block.settings.toggle_right }}">
  <img src="{{ "gizmo.png" | asset_img_url: 'large' }}" alt="Chat Icon" loading="lazy">
</div>

<!-- Ventana del chat -->
<div id="chatbot-window">
  <div class="chatbot-header">
    <div class="brand">
      <img src="{{ "gizmo.png" | asset_img_url: 'large' }}" alt="Zendra" loading="lazy">
      <span>Zendra</span>
    </div>
  </div>
  <div class="chatbot-body" id="chatbotBody">
    <!-- Mensajes se cargarán aquí dinámicamente -->
  </div>
  <div class="chatbot-footer">
    <input type="text" id="userInput" placeholder="{{ 'chatbot.input.placeholder' | t }}" autocomplete="off">
    <button id="sendBtn">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M22 2L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
  </div>
</div>

{% schema %}
{
  "name": "Zendra Chatbot",
  "target": "body",
  "settings": [
    {
      "type": "text",
      "label": "Posición inferior",
      "id": "toggle_bottom",
      "default": "20px",
      "info": "Distancia desde el borde inferior de la pantalla"
    },
    {
      "type": "text",
      "label": "Posición derecha",
      "id": "toggle_right",
      "default": "20px",
      "info": "Distancia desde el borde derecho de la pantalla"
    }
  ],
  "locales": {
    "es": {
      "chatbot": {
        "input": {
          "placeholder": "Escribe tu mensaje..."
        }
      }
    },
    "en": {
      "chatbot": {
        "input": {
          "placeholder": "Escribe tu mensaje..."
        }
      }
    }
  }
}
{% endschema %}
